import{u as J,r as o,a as K,d as S,j as e,H as Q,b as V}from"./app-DqUNRcaX.js";import{A as X,b as Y}from"./alert-CzDU0KpZ.js";import{B as Z}from"./button-Bojtm6w9.js";import{C as u,a as p,b as g,c as b,d as h}from"./card-DhDj-S6h.js";import{I as ee}from"./input-C-9n9zcL.js";import{L as d}from"./label-CQVZAT69.js";import{A as te}from"./app-layout-Du4u57K6.js";import{r as F}from"./image-compression-C1UeteK-.js";import{CategorySelect as se}from"./CategorySelect-D5LmbpRt.js";import{ContentEditor as ae}from"./ContentEditor-Djs0EZOp.js";import{ExcerptInput as re}from"./ExcerptInput-LdJz6ywU.js";import{FeaturedToggle as ie}from"./FeaturedToggle-BrbJQKSQ.js";import{FormActions as oe}from"./FormActions-DPQYMlQ6.js";import{FormHeader as le}from"./FormHeader-DGqCWWjw.js";import{PublishDateInput as ne}from"./PublishDateInput-BFuf--8d.js";import{StatusSelect as ce}from"./StatusSelect-CGN5fco7.js";import{SubCategorySelect as de}from"./SubCategorySelect-BNb7CzWw.js";import{TagsInput as me}from"./TagsInput-DrYxmv09.js";import{ThumbnailUpload as ue}from"./ThumbnailUpload-Bci2Tdpg.js";import{TitleSlugInput as pe}from"./TitleSlugInput-CFYqus77.js";import{C as ge}from"./circle-check-BoT8TG0l.js";import{c as he}from"./createLucideIcon-CQKJRB3B.js";/* empty css            */import"./utils-D0Zg16Wk.js";import"./index-CZghf1bC.js";import"./index-BBKbAFBh.js";import"./sheet-S2pXNwnv.js";import"./index-w-EmsIHH.js";import"./Combination-BHIsmqNu.js";import"./index-GmT6DGBO.js";import"./x-ut0ZfEcV.js";import"./index-DUwdp-Pb.js";import"./index-CPUdE6SV.js";import"./index-CT6d_Hz-.js";import"./dropdown-menu-DJF_wl_T.js";import"./index-DSOkqTVi.js";import"./index-CMWG4mbA.js";import"./app-logo-icon-DjT681yc.js";import"./select-R_gYMy5a.js";import"./index-jukUuInv.js";import"./check-C2m5ChYP.js";import"./plus-CjhFYHt6.js";import"./textarea-00zh3rQS.js";import"./switch-j4MgvFJc.js";import"./index-DGdR22o3.js";import"./loader-circle-Cl7txlyv.js";import"./chevron-left-DNP3p8tY.js";import"./badge-BcXQzHgJ.js";import"./image-rcZv3PoX.js";const xe=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],fe=he("WandSparkles",xe);function gt(){const{props:T}=J(),{categories:L=[],sub_categories:E=[],tags:A=[],post:i=null,flash:j={}}=T||{},l=!!i,y=o.useRef(null),[D,C]=o.useState(i?.thumbnail_url||null),[P,U]=o.useState(typeof window<"u"&&window.innerWidth<1024),[I,be]=o.useState(()=>typeof document<"u"&&document.documentElement.classList.contains("dark")),[x,z]=o.useState(""),[w,N]=o.useState(null),[_,k]=o.useState(!1),{data:r,setData:a,processing:M,errors:c}=K({category_id:i?.category_id||null,category_name:"",sub_category_id:i?.sub_category_id||null,title:i?.title||"",slug:i?.slug||"",excerpt:i?.excerpt||"",content:i?.content||"",status:i?.status||"published",is_featured:i?.is_featured||!1,thumbnail:null,tags:i?.tags.map(t=>t.name)||[],published_at:i?.published_at||(i?null:new Date().toISOString().split("T")[0])}),v=o.useCallback(async t=>{try{const s=await fetch(t);if(!s.ok)throw new Error("Failed to fetch thumbnail");const n=await s.blob(),m=t.split("/").pop()||"thumbnail.jpg",G=new File([n],m,{type:n.type||"image/jpeg"});C(t),a("thumbnail",G)}catch(s){console.error("Error fetching thumbnail:",s)}},[a]),f=o.useCallback(t=>{a("title",t),l||a("slug",t.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,""))},[a,l]),R=o.useCallback(async()=>{const t=x.trim();if(t){k(!0),N(null);try{const{data:s}=await S.get("https://test1-gl4j.vercel.app/extract",{params:{url:t}});s?.title&&f(s.title),s?.content&&a("content",s.content),s?.tags?.length&&a("tags",[...new Set(s.tags.map(n=>n.toLowerCase().trim()).filter(Boolean))]),s?.thumbnail&&await v(s.thumbnail)}catch(s){console.error("Auto fill failed:",s),N("Gagal mengambil data dari URL. Coba lagi.")}finally{k(!1)}}},[x,f,a,v]),B=o.useCallback(async t=>{const s=t.target.files?.[0];if(s)try{const n=await F(s,1200,800),m=new File([n],s.name,{type:s.type});C(URL.createObjectURL(m)),a("thumbnail",m)}catch(n){console.error("Failed to resize thumbnail:",n)}},[a]),H=o.useCallback(t=>{const s=t.toLowerCase().trim();s&&!r.tags.includes(s)&&a("tags",[...r.tags,s])},[r.tags,a]),O=o.useCallback(t=>{a("tags",r.tags.filter(s=>s!==t))},[r.tags,a]),W=o.useCallback(async t=>{try{const s=await F(t.blob(),1200,800),n=new FormData;n.append("image",s,t.filename()),l&&i?.id&&n.append("news_id",i.id.toString());const{data:m}=await S.post("/dashboard/posts/upload-image",n);return m.url}catch{throw new Error("Upload failed")}},[l,i?.id]),$=t=>{t.preventDefault();const s=y.current?.getContent()||r.content;V.post(l?`/dashboard/posts/${i?.id}`:"/dashboard/posts",{...r,content:s,_method:l?"PUT":"POST"},{forceFormData:!0})};o.useEffect(()=>{const t=()=>U(window.innerWidth<1024);return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const q=[{title:"Dashboard",href:"/dashboard"},{title:"Posts",href:"/dashboard/posts"},{title:l?"Edit":"Create",href:"#"}];return e.jsxs(te,{breadcrumbs:q,children:[e.jsx(Q,{title:`${l?"Edit":"Create"} Post`}),e.jsxs("form",{onSubmit:$,className:"mx-auto max-w-[98%] space-y-4 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(le,{isEdit:l}),e.jsx(oe,{isEdit:l,processing:M})]}),j?.success&&e.jsxs(X,{className:"border-green-500/50 bg-green-500/5",children:[e.jsx(ge,{className:"h-4 w-4 text-green-600"}),e.jsx(Y,{className:"text-green-600",children:j.success})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-12",children:[e.jsxs("div",{className:"space-y-6 lg:col-span-9",children:[!l&&e.jsxs(u,{children:[e.jsxs(p,{className:"space-y-1",children:[e.jsx(g,{className:"text-lg",children:"Auto Fill"}),e.jsx(b,{children:"Masukkan URL artikel untuk mengisi otomatis judul, konten, tag, dan thumbnail."})]}),e.jsxs(h,{className:"grid gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row",children:[e.jsx(ee,{placeholder:"https://...",value:x,onChange:t=>z(t.target.value),className:"flex-1"}),e.jsxs(Z,{type:"button",onClick:R,disabled:_||!x.trim(),className:"shrink-0",children:[e.jsx(fe,{className:"mr-2 h-4 w-4"}),_?"Mengisi...":"Auto Fill"]})]}),w&&e.jsx("p",{className:"text-sm font-medium text-destructive",children:w})]})]}),e.jsxs(u,{children:[e.jsxs(p,{className:"space-y-1",children:[e.jsx(g,{className:"text-lg",children:"Content"}),e.jsx(b,{children:"Write your post title and body here."})]}),e.jsxs(h,{className:"grid gap-6",children:[e.jsx(pe,{title:r.title,slug:r.slug,isEdit:l,onTitleChange:f,onSlugChange:t=>a("slug",t),errors:c}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{className:"text-sm font-semibold",children:"Body Content"}),e.jsx(ae,{ref:y,value:r.content,onChange:t=>a("content",t),imageHandler:W,useDarkMode:I,isSmallScreen:P,error:c.content})]})]})]}),e.jsxs(u,{children:[e.jsxs(p,{className:"space-y-1",children:[e.jsx(g,{className:"text-lg",children:"Summary"}),e.jsx(b,{children:"Brief summary for SEO. If left empty, it will be generated from content."})]}),e.jsx(h,{className:"grid gap-2",children:e.jsx(re,{value:r.excerpt,onChange:t=>a("excerpt",t),error:c.excerpt})})]})]}),e.jsxs("div",{className:"space-y-6 lg:col-span-3",children:[e.jsxs(u,{children:[e.jsx(p,{className:"space-y-1",children:e.jsx(g,{className:"text-base",children:"Publishing"})}),e.jsxs(h,{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{className:"text-xs tracking-wider text-muted-foreground uppercase",children:"Post Status"}),e.jsx(ce,{value:r.status,onChange:t=>a("status",t),error:c.status})]}),r.status==="published"&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{className:"text-xs tracking-wider text-muted-foreground uppercase",children:"Publish Date"}),e.jsx(ne,{value:r.published_at,onChange:t=>a("published_at",t),error:c.published_at})]}),e.jsx(ie,{value:r.is_featured,onChange:t=>a("is_featured",t)})]})]}),e.jsxs(u,{children:[e.jsx(p,{className:"space-y-1",children:e.jsx(g,{className:"text-base",children:"Organization"})}),e.jsxs(h,{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{className:"text-xs tracking-wider text-muted-foreground uppercase",children:"Category"}),e.jsx(se,{categories:L,value:r.category_id?String(r.category_id):"",onChange:t=>{a("category_id",parseInt(t)),a("category_name",""),a("sub_category_id",null)},onCreateCategory:t=>{a("category_id",null),a("category_name",t),a("sub_category_id",null)},error:c.category_id||c.category_name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{className:"text-xs tracking-wider text-muted-foreground uppercase",children:"Sub Category"}),e.jsx(de,{subCategories:E,categoryId:r.category_id,value:r.sub_category_id,onChange:t=>a("sub_category_id",t),error:c.sub_category_id})]})]})]}),e.jsxs(u,{children:[e.jsx(p,{className:"space-y-1",children:e.jsx(g,{className:"text-base",children:"Media & Tags"})}),e.jsxs(h,{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{className:"text-center text-xs tracking-wider text-muted-foreground uppercase",children:"Thumbnail"}),e.jsx(ue,{previewUrl:D,onChange:B,error:c.thumbnail})]}),e.jsxs("div",{className:"grid gap-2 border-t pt-4",children:[e.jsx(d,{className:"text-xs tracking-wider text-muted-foreground uppercase",children:"Post Tags"}),e.jsx(me,{tags:r.tags,availableTags:A,onAddTag:H,onRemoveTag:O,error:c.tags})]})]})]})]})]})]})]})}export{gt as default};
