import{u as R,r as n,a as U,d as H,j as e,H as B,b as O}from"./app-DwYhUbFD.js";import{A as M,b as W}from"./alert-DKpLdQz_.js";import{C as m,a as p,b as u,c as j,d as g}from"./card-vYzdOLrH.js";import{L as d}from"./label-CwocWEfa.js";import{A as $}from"./app-layout-Cs3omUC6.js";import{r as b}from"./image-compression-C1UeteK-.js";import{CategorySelect as q}from"./CategorySelect-BamOA1yM.js";import{ContentEditor as G}from"./ContentEditor-B4dHj5Ft.js";import{ExcerptInput as J}from"./ExcerptInput-jJKoHhzm.js";import{FeaturedToggle as K}from"./FeaturedToggle-Cexpv6l4.js";import{FormActions as Q}from"./FormActions-DPElNUi4.js";import{FormHeader as V}from"./FormHeader-B-95GhpG.js";import{PublishDateInput as X}from"./PublishDateInput-CV68UWWe.js";import{StatusSelect as Y}from"./StatusSelect-CKcjF-du.js";import{SubCategorySelect as Z}from"./SubCategorySelect-Bi-a0LQ9.js";import{TagsInput as ee}from"./TagsInput-t9gJ9ov2.js";import{ThumbnailUpload as se}from"./ThumbnailUpload-vZZXRUN_.js";import{TitleSlugInput as te}from"./TitleSlugInput-D8sZLkbM.js";import{C as re}from"./circle-check-j9mBlq3o.js";/* empty css            */import"./button-CcueVF--.js";import"./index-DhKngAEP.js";import"./utils-D0Zg16Wk.js";import"./index-CfIvfTC2.js";import"./sheet-zlfE-5B4.js";import"./index-CS4WM3vw.js";import"./Combination-CoFKdG7U.js";import"./index-BeWhH1Qs.js";import"./x-D9fBIHXo.js";import"./createLucideIcon-CznxfoMw.js";import"./index-BMq2OniD.js";import"./index-BpSvTejM.js";import"./index-BgN-6-E9.js";import"./dropdown-menu-DNV6jZYD.js";import"./index-DSOkqTVi.js";import"./index-CMWG4mbA.js";import"./app-logo-icon-B-q8qzBG.js";import"./chevron-right-BrJB21wp.js";import"./select-CYzAyHhP.js";import"./index-CihGyieV.js";import"./check-BImFCEdY.js";import"./textarea-BTTDm0Pv.js";import"./switch-B3ed7PGQ.js";import"./index-DGdR22o3.js";import"./loader-circle-Co0MIrn4.js";import"./chevron-left-KKM1Z3fA.js";import"./input-DTAyzQ0a.js";import"./badge-DDgJTv2E.js";import"./plus-C02fu0MX.js";import"./image-B_mmgC7d.js";function ss(){const{props:y}=R(),{categories:C=[],sub_categories:N=[],tags:w=[],post:a=null,flash:h={}}=y||{},o=!!a,f=n.useRef(null),[_,v]=n.useState(a?.thumbnail_url||null),[S,T]=n.useState(typeof window<"u"&&window.innerWidth<1024),[k,ae]=n.useState(()=>typeof document<"u"&&document.documentElement.classList.contains("dark")),{data:t,setData:r,processing:E,errors:l}=U({category_id:a?.category_id||1,sub_category_id:a?.sub_category_id||null,title:a?.title||"",slug:a?.slug||"",excerpt:a?.excerpt||"",content:a?.content||"",status:a?.status||"draft",is_featured:a?.is_featured||!1,thumbnail:null,tags:a?.tags.map(s=>s.name)||[],published_at:a?.published_at||null}),P=n.useCallback(s=>{r("title",s),o||r("slug",s.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,""))},[r,o]),D=n.useCallback(async s=>{const i=s.target.files?.[0];if(i)try{const c=await b(i,1200,800),x=new File([c],i.name,{type:i.type});v(URL.createObjectURL(x)),r("thumbnail",x)}catch(c){console.error("Failed to resize thumbnail:",c)}},[r]),z=n.useCallback(s=>{const i=s.toLowerCase().trim();i&&!t.tags.includes(i)&&r("tags",[...t.tags,i])},[t.tags,r]),F=n.useCallback(s=>{r("tags",t.tags.filter(i=>i!==s))},[t.tags,r]),L=n.useCallback(async s=>{try{const i=await b(s.blob(),1200,800),c=new FormData;c.append("image",i,s.filename()),o&&a?.id&&c.append("news_id",a.id.toString());const{data:x}=await H.post("/dashboard/posts/upload-image",c);return x.url}catch{throw new Error("Upload failed")}},[o,a?.id]),I=s=>{s.preventDefault();const i=f.current?.getContent()||t.content;O.post(o?`/dashboard/posts/${a?.id}`:"/dashboard/posts",{...t,content:i,_method:o?"PUT":"POST"},{forceFormData:!0})};n.useEffect(()=>{const s=()=>T(window.innerWidth<1024);return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]);const A=[{title:"Dashboard",href:"/dashboard"},{title:"Posts",href:"/dashboard/posts"},{title:o?"Edit":"Create",href:"#"}];return e.jsxs($,{breadcrumbs:A,children:[e.jsx(B,{title:`${o?"Edit":"Create"} Post`}),e.jsxs("form",{onSubmit:I,className:"mx-auto max-w-[98%] space-y-4 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(V,{isEdit:o}),e.jsx(Q,{isEdit:o,processing:E})]}),h?.success&&e.jsxs(M,{className:"border-green-500/50 bg-green-500/5",children:[e.jsx(re,{className:"h-4 w-4 text-green-600"}),e.jsx(W,{className:"text-green-600",children:h.success})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-12",children:[e.jsxs("div",{className:"space-y-6 lg:col-span-9",children:[e.jsxs(m,{children:[e.jsxs(p,{className:"space-y-1",children:[e.jsx(u,{className:"text-lg",children:"Content"}),e.jsx(j,{children:"Write your post title and body here."})]}),e.jsxs(g,{className:"grid gap-6",children:[e.jsx(te,{title:t.title,slug:t.slug,isEdit:o,onTitleChange:P,onSlugChange:s=>r("slug",s),errors:l}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{className:"text-sm font-semibold",children:"Body Content"}),e.jsx(G,{ref:f,value:t.content,onChange:s=>r("content",s),imageHandler:L,useDarkMode:k,isSmallScreen:S,error:l.content})]})]})]}),e.jsxs(m,{children:[e.jsxs(p,{className:"space-y-1",children:[e.jsx(u,{className:"text-lg",children:"Summary"}),e.jsx(j,{children:"Brief summary for SEO. If left empty, it will be generated from content."})]}),e.jsx(g,{className:"grid gap-2",children:e.jsx(J,{value:t.excerpt,onChange:s=>r("excerpt",s),error:l.excerpt})})]})]}),e.jsxs("div",{className:"space-y-6 lg:col-span-3",children:[e.jsxs(m,{children:[e.jsx(p,{className:"space-y-1",children:e.jsx(u,{className:"text-base",children:"Publishing"})}),e.jsxs(g,{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{className:"text-xs tracking-wider text-muted-foreground uppercase",children:"Post Status"}),e.jsx(Y,{value:t.status,onChange:s=>r("status",s),error:l.status})]}),t.status==="published"&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{className:"text-xs tracking-wider text-muted-foreground uppercase",children:"Publish Date"}),e.jsx(X,{value:t.published_at,onChange:s=>r("published_at",s),error:l.published_at})]}),e.jsx(K,{value:t.is_featured,onChange:s=>r("is_featured",s)})]})]}),e.jsxs(m,{children:[e.jsx(p,{className:"space-y-1",children:e.jsx(u,{className:"text-base",children:"Organization"})}),e.jsxs(g,{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{className:"text-xs tracking-wider text-muted-foreground uppercase",children:"Category"}),e.jsx(q,{categories:C,value:String(t.category_id),onChange:s=>{r("category_id",parseInt(s)),r("sub_category_id",null)},error:l.category_id})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{className:"text-xs tracking-wider text-muted-foreground uppercase",children:"Sub Category"}),e.jsx(Z,{subCategories:N,categoryId:t.category_id,value:t.sub_category_id,onChange:s=>r("sub_category_id",s),error:l.sub_category_id})]})]})]}),e.jsxs(m,{children:[e.jsx(p,{className:"space-y-1",children:e.jsx(u,{className:"text-base",children:"Media & Tags"})}),e.jsxs(g,{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{className:"text-center text-xs tracking-wider text-muted-foreground uppercase",children:"Thumbnail"}),e.jsx(se,{previewUrl:_,onChange:D,error:l.thumbnail})]}),e.jsxs("div",{className:"grid gap-2 border-t pt-4",children:[e.jsx(d,{className:"text-xs tracking-wider text-muted-foreground uppercase",children:"Post Tags"}),e.jsx(ee,{tags:t.tags,availableTags:w,onAddTag:z,onRemoveTag:F,error:l.tags})]})]})]})]})]})]})]})}export{ss as default};
