import{r as b,u as Be,a as Fe,d as pe,b as M,j as t,H as Ae,L as fe}from"./app-CTB2sItS.js";import{A as G,a as $,b as J,C as he}from"./alert-LwFJJ54O.js";import{B as Me}from"./badge-BfHisHoH.js";import{B as U}from"./button-xUSbhuCb.js";import{C as B,a as H,b as z,c as X,d as V}from"./card-Q42CSk8h.js";import{I as Y}from"./input-x3-30NCg.js";import{L as T}from"./label-BtkA_vih.js";import{S as Q,a as Z,b as ee,c as te,d as P}from"./select-DkDDR8Qt.js";import{S as Ue}from"./switch-EOb4KuyM.js";import{T as He}from"./textarea-BgMhzeH1.js";import{A as ze}from"./app-layout-Cs703iEf.js";import{r as Ve}from"./image-compression-C1UeteK-.js";import{d as I}from"./index-DGdR22o3.js";import{C as qe}from"./circle-check-CC07nFvz.js";import{c as we}from"./createLucideIcon-CgSRsmC4.js";import{X as Ke}from"./sheet-Bj8eZ98O.js";import{P as We}from"./plus-_3XeA6BP.js";import{L as Ge}from"./loader-circle-DUzmf4LM.js";/* empty css            */import"./index-D0gxOiZZ.js";import"./index-DXDrmP-1.js";import"./index-BxGkpuVN.js";import"./dropdown-menu-ClFsFiP9.js";import"./Combination-DNJNFLBc.js";import"./index-COAM7Pl-.js";import"./index-B7miRuv-.js";import"./check-Bw97LkpH.js";import"./index-DSOkqTVi.js";import"./index-CMWG4mbA.js";import"./app-logo-icon-D_b2OmWx.js";const $e=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Je=we("ChevronLeft",$e);const Xe=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],Ye=we("Upload",Xe);var ne={exports:{}},re,me;function Qe(){if(me)return re;me=1;var i="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return re=i,re}var ie,ve;function Ze(){if(ve)return ie;ve=1;var i=Qe();function o(){}function c(){}return c.resetWarningCache=o,ie=function(){function a(e,l,u,p,m,f){if(f!==i){var v=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw v.name="Invariant Violation",v}}a.isRequired=a;function r(){return a}var d={array:a,bigint:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:r,element:a,elementType:a,instanceOf:r,node:a,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:c,resetWarningCache:o};return d.PropTypes=d,d},ie}var ge;function et(){return ge||(ge=1,ne.exports=Ze()()),ne.exports}var n=et(),se=function(){return se=Object.assign||function(i){for(var o,c=1,a=arguments.length;c<a;c++){o=arguments[c];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(i[r]=o[r])}return i},se.apply(this,arguments)},ke={onActivate:n.func,onAddUndo:n.func,onBeforeAddUndo:n.func,onBeforeExecCommand:n.func,onBeforeGetContent:n.func,onBeforeRenderUI:n.func,onBeforeSetContent:n.func,onBeforePaste:n.func,onBlur:n.func,onChange:n.func,onClearUndos:n.func,onClick:n.func,onContextMenu:n.func,onCommentChange:n.func,onCompositionEnd:n.func,onCompositionStart:n.func,onCompositionUpdate:n.func,onCopy:n.func,onCut:n.func,onDblclick:n.func,onDeactivate:n.func,onDirty:n.func,onDrag:n.func,onDragDrop:n.func,onDragEnd:n.func,onDragGesture:n.func,onDragOver:n.func,onDrop:n.func,onExecCommand:n.func,onFocus:n.func,onFocusIn:n.func,onFocusOut:n.func,onGetContent:n.func,onHide:n.func,onInit:n.func,onInput:n.func,onKeyDown:n.func,onKeyPress:n.func,onKeyUp:n.func,onLoadContent:n.func,onMouseDown:n.func,onMouseEnter:n.func,onMouseLeave:n.func,onMouseMove:n.func,onMouseOut:n.func,onMouseOver:n.func,onMouseUp:n.func,onNodeChange:n.func,onObjectResizeStart:n.func,onObjectResized:n.func,onObjectSelected:n.func,onPaste:n.func,onPostProcess:n.func,onPostRender:n.func,onPreProcess:n.func,onProgressState:n.func,onRedo:n.func,onRemove:n.func,onReset:n.func,onSaveContent:n.func,onSelectionChange:n.func,onSetAttrib:n.func,onSetContent:n.func,onShow:n.func,onSubmit:n.func,onUndo:n.func,onVisualAid:n.func,onSkinLoadError:n.func,onThemeLoadError:n.func,onModelLoadError:n.func,onPluginLoadError:n.func,onIconsLoadError:n.func,onLanguageLoadError:n.func,onScriptsLoad:n.func,onScriptsLoadError:n.func},tt=se({apiKey:n.string,licenseKey:n.string,id:n.string,inline:n.bool,init:n.object,initialValue:n.string,onEditorChange:n.func,value:n.string,tagName:n.string,tabIndex:n.number,cloudChannel:n.string,plugins:n.oneOfType([n.string,n.array]),toolbar:n.oneOfType([n.string,n.array]),disabled:n.bool,readonly:n.bool,textareaName:n.string,tinymceScriptSrc:n.oneOfType([n.string,n.arrayOf(n.string),n.arrayOf(n.shape({src:n.string,async:n.bool,defer:n.bool}))]),rollback:n.oneOfType([n.number,n.oneOf([!1])]),scriptLoading:n.shape({async:n.bool,defer:n.bool,delay:n.number})},ke),Ee=function(i){var o=i;return o&&o.tinymce?o.tinymce:null},oe=function(i){return typeof i=="function"},ye=function(i){return i in ke},xe=function(i){return i.substr(2)},nt=function(i,o,c,a,r,d,e){var l=Object.keys(r).filter(ye),u=Object.keys(d).filter(ye),p=l.filter(function(f){return d[f]===void 0}),m=u.filter(function(f){return r[f]===void 0});p.forEach(function(f){var v=xe(f),_=e[v];c(v,_),delete e[v]}),m.forEach(function(f){var v=a(i,f),_=xe(f);e[_]=v,o(_,v)})},rt=function(i,o,c,a,r){return nt(r,i.on.bind(i),i.off.bind(i),function(d,e){return function(l){var u;return(u=d(e))===null||u===void 0?void 0:u(l,i)}},o,c,a)},be=0,Ne=function(i){var o=Date.now(),c=Math.floor(Math.random()*1e9);return be++,i+"_"+c+be+String(o)},je=function(i){return i!==null&&(i.tagName.toLowerCase()==="textarea"||i.tagName.toLowerCase()==="input")},_e=function(i){return typeof i>"u"||i===""?[]:Array.isArray(i)?i:i.split(" ")},it=function(i,o){return _e(i).concat(_e(o))},ot=function(){return window.InputEvent&&typeof InputEvent.prototype.getTargetRanges=="function"},at=function(i){if(!("isConnected"in Node.prototype)){for(var o=i,c=i.parentNode;c!=null;)o=c,c=o.parentNode;return o===i.ownerDocument}return i.isConnected},Ce=function(i,o){i!==void 0&&(i.mode!=null&&typeof i.mode=="object"&&typeof i.mode.set=="function"?i.mode.set(o):i.setMode(o))},st=function(i){var o=Ee(i);if(!o)throw new Error("tinymce should have been loaded into global scope");return o},Se=function(i){return i.options&&i.options.isRegistered("disabled")},ce=function(){return ce=Object.assign||function(i){for(var o,c=1,a=arguments.length;c<a;c++){o=arguments[c];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(i[r]=o[r])}return i},ce.apply(this,arguments)},ct=function(i,o,c){var a,r,d=i.createElement("script");d.referrerPolicy="origin",d.type="application/javascript",d.id=o.id,d.src=o.src,d.async=(a=o.async)!==null&&a!==void 0?a:!1,d.defer=(r=o.defer)!==null&&r!==void 0?r:!1;var e=function(){d.removeEventListener("load",e),d.removeEventListener("error",l),c(o.src)},l=function(u){d.removeEventListener("load",e),d.removeEventListener("error",l),c(o.src,u)};d.addEventListener("load",e),d.addEventListener("error",l),i.head&&i.head.appendChild(d)},lt=function(i){var o={},c=function(e,l){var u=o[e];u.done=!0,u.error=l;for(var p=0,m=u.handlers;p<m.length;p++){var f=m[p];f(e,l)}u.handlers=[]},a=function(e,l,u){var p=function(R){return u!==void 0?u(R):console.error(R)};if(e.length===0){p(new Error("At least one script must be provided"));return}for(var m=0,f=!1,v=function(R,F){f||(F?(f=!0,p(F)):++m===e.length&&l())},_=0,y=e;_<y.length;_++){var S=y[_],E=o[S.src];if(E)E.done?v(S.src,E.error):E.handlers.push(v);else{var L=Ne("tiny-");o[S.src]={id:L,src:S.src,done:!1,error:null,handlers:[v]},ct(i,ce({id:L},S),c)}}},r=function(){for(var e,l=0,u=Object.values(o);l<u.length;l++){var p=u[l],m=i.getElementById(p.id);m!=null&&m.tagName==="SCRIPT"&&((e=m.parentNode)===null||e===void 0||e.removeChild(m))}o={}},d=function(){return i};return{loadScripts:a,deleteScripts:r,getDocument:d}},dt=function(){var i=[],o=function(r){var d=i.find(function(e){return e.getDocument()===r});return d===void 0&&(d=lt(r),i.push(d)),d},c=function(r,d,e,l,u){var p=function(){return o(r).loadScripts(d,l,u)};e>0?setTimeout(p,e):p()},a=function(){for(var r=i.pop();r!=null;r=i.pop())r.deleteScripts()};return{loadList:c,reinitialize:a}},ut=dt(),pt=(function(){var i=function(o,c){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,r){a.__proto__=r}||function(a,r){for(var d in r)Object.prototype.hasOwnProperty.call(r,d)&&(a[d]=r[d])},i(o,c)};return function(o,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");i(o,c);function a(){this.constructor=o}o.prototype=c===null?Object.create(c):(a.prototype=c.prototype,new a)}})(),O=function(){return O=Object.assign||function(i){for(var o,c=1,a=arguments.length;c<a;c++){o=arguments[c];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(i[r]=o[r])}return i},O.apply(this,arguments)},ae="change keyup compositionend setcontent CommentChange",ft=(function(i){pt(o,i);function o(c){var a,r,d,e=i.call(this,c)||this;return e.rollbackTimer=void 0,e.valueCursor=void 0,e.rollbackChange=function(){var l=e.editor,u=e.props.value;l&&u&&u!==e.currentContent&&l.undoManager.ignore(function(){if(l.setContent(u),e.valueCursor&&(!e.inline||l.hasFocus()))try{l.selection.moveToBookmark(e.valueCursor)}catch{}}),e.rollbackTimer=void 0},e.handleBeforeInput=function(l){if(e.props.value!==void 0&&e.props.value===e.currentContent&&e.editor&&(!e.inline||e.editor.hasFocus()))try{e.valueCursor=e.editor.selection.getBookmark(3)}catch{}},e.handleBeforeInputSpecial=function(l){(l.key==="Enter"||l.key==="Backspace"||l.key==="Delete")&&e.handleBeforeInput(l)},e.handleEditorChange=function(l){var u=e.editor;if(u&&u.initialized){var p=u.getContent();e.props.value!==void 0&&e.props.value!==p&&e.props.rollback!==!1&&(e.rollbackTimer||(e.rollbackTimer=window.setTimeout(e.rollbackChange,typeof e.props.rollback=="number"?e.props.rollback:200))),p!==e.currentContent&&(e.currentContent=p,oe(e.props.onEditorChange)&&e.props.onEditorChange(p,u))}},e.handleEditorChangeSpecial=function(l){(l.key==="Backspace"||l.key==="Delete")&&e.handleEditorChange(l)},e.initialise=function(l){var u,p,m;l===void 0&&(l=0);var f=e.elementRef.current;if(f){if(!at(f)){if(l===0)setTimeout(function(){return e.initialise(1)},1);else if(l<100)setTimeout(function(){return e.initialise(l+1)},100);else throw new Error("tinymce can only be initialised when in a document");return}var v=st(e.view),_=O(O(O(O({},e.props.init),{selector:void 0,target:f,disabled:e.props.disabled,readonly:e.props.readonly,inline:e.inline,plugins:it((u=e.props.init)===null||u===void 0?void 0:u.plugins,e.props.plugins),toolbar:(p=e.props.toolbar)!==null&&p!==void 0?p:(m=e.props.init)===null||m===void 0?void 0:m.toolbar}),e.props.licenseKey?{license_key:e.props.licenseKey}:{}),{setup:function(y){e.editor=y,e.bindHandlers({}),e.inline&&!je(f)&&y.once("PostRender",function(S){y.setContent(e.getInitialValue(),{no_events:!0})}),e.props.init&&oe(e.props.init.setup)&&e.props.init.setup(y),e.props.disabled&&(Se(e.editor)?e.editor.options.set("disabled",e.props.disabled):e.editor.mode.set("readonly"))},init_instance_callback:function(y){var S,E=e.getInitialValue();e.currentContent=(S=e.currentContent)!==null&&S!==void 0?S:y.getContent(),e.currentContent!==E&&(e.currentContent=E,y.setContent(E),y.undoManager.clear(),y.undoManager.add(),y.setDirty(!1)),e.props.init&&oe(e.props.init.init_instance_callback)&&e.props.init.init_instance_callback(y)}});e.inline||(f.style.visibility=""),je(f)&&(f.value=e.getInitialValue()),v.init(_)}},e.id=e.props.id||Ne("tiny-react"),e.elementRef=b.createRef(),e.inline=(d=(a=e.props.inline)!==null&&a!==void 0?a:(r=e.props.init)===null||r===void 0?void 0:r.inline)!==null&&d!==void 0?d:!1,e.boundHandlers={},e}return Object.defineProperty(o.prototype,"view",{get:function(){var c,a;return(a=(c=this.elementRef.current)===null||c===void 0?void 0:c.ownerDocument.defaultView)!==null&&a!==void 0?a:window},enumerable:!1,configurable:!0}),o.prototype.componentDidUpdate=function(c){var a=this,r,d;if(this.rollbackTimer&&(clearTimeout(this.rollbackTimer),this.rollbackTimer=void 0),this.editor&&(this.bindHandlers(c),this.editor.initialized)){if(this.currentContent=(r=this.currentContent)!==null&&r!==void 0?r:this.editor.getContent(),typeof this.props.initialValue=="string"&&this.props.initialValue!==c.initialValue)this.editor.setContent(this.props.initialValue),this.editor.undoManager.clear(),this.editor.undoManager.add(),this.editor.setDirty(!1);else if(typeof this.props.value=="string"&&this.props.value!==this.currentContent){var e=this.editor;e.undoManager.transact(function(){var u;if(!a.inline||e.hasFocus())try{u=e.selection.getBookmark(3)}catch{}var p=a.valueCursor;if(e.setContent(a.props.value),!a.inline||e.hasFocus())for(var m=0,f=[u,p];m<f.length;m++){var v=f[m];if(v)try{e.selection.moveToBookmark(v),a.valueCursor=v;break}catch{}}})}if(this.props.readonly!==c.readonly){var l=(d=this.props.readonly)!==null&&d!==void 0?d:!1;Ce(this.editor,l?"readonly":"design")}this.props.disabled!==c.disabled&&(Se(this.editor)?this.editor.options.set("disabled",this.props.disabled):Ce(this.editor,this.props.disabled?"readonly":"design"))}},o.prototype.componentDidMount=function(){var c=this,a,r,d,e,l;if(Ee(this.view)!==null)this.initialise();else if(Array.isArray(this.props.tinymceScriptSrc)&&this.props.tinymceScriptSrc.length===0)(r=(a=this.props).onScriptsLoadError)===null||r===void 0||r.call(a,new Error("No `tinymce` global is present but the `tinymceScriptSrc` prop was an empty array."));else if(!((d=this.elementRef.current)===null||d===void 0)&&d.ownerDocument){var u=function(){var m,f;(f=(m=c.props).onScriptsLoad)===null||f===void 0||f.call(m),c.initialise()},p=function(m){var f,v;(v=(f=c.props).onScriptsLoadError)===null||v===void 0||v.call(f,m)};ut.loadList(this.elementRef.current.ownerDocument,this.getScriptSources(),(l=(e=this.props.scriptLoading)===null||e===void 0?void 0:e.delay)!==null&&l!==void 0?l:0,u,p)}},o.prototype.componentWillUnmount=function(){var c=this,a=this.editor;a&&(a.off(ae,this.handleEditorChange),a.off(this.beforeInputEvent(),this.handleBeforeInput),a.off("keypress",this.handleEditorChangeSpecial),a.off("keydown",this.handleBeforeInputSpecial),a.off("NewBlock",this.handleEditorChange),Object.keys(this.boundHandlers).forEach(function(r){a.off(r,c.boundHandlers[r])}),this.boundHandlers={},a.remove(),this.editor=void 0)},o.prototype.render=function(){return this.inline?this.renderInline():this.renderIframe()},o.prototype.beforeInputEvent=function(){return ot()?"beforeinput SelectionChange":"SelectionChange"},o.prototype.renderInline=function(){var c=this.props.tagName,a=c===void 0?"div":c;return b.createElement(a,{ref:this.elementRef,id:this.id,tabIndex:this.props.tabIndex})},o.prototype.renderIframe=function(){return b.createElement("textarea",{ref:this.elementRef,style:{visibility:"hidden"},name:this.props.textareaName,id:this.id,tabIndex:this.props.tabIndex})},o.prototype.getScriptSources=function(){var c,a,r=(c=this.props.scriptLoading)===null||c===void 0?void 0:c.async,d=(a=this.props.scriptLoading)===null||a===void 0?void 0:a.defer;if(this.props.tinymceScriptSrc!==void 0)return typeof this.props.tinymceScriptSrc=="string"?[{src:this.props.tinymceScriptSrc,async:r,defer:d}]:this.props.tinymceScriptSrc.map(function(p){return typeof p=="string"?{src:p,async:r,defer:d}:p});var e=this.props.cloudChannel,l=this.props.apiKey?this.props.apiKey:"no-api-key",u="https://cdn.tiny.cloud/1/".concat(l,"/tinymce/").concat(e,"/tinymce.min.js");return[{src:u,async:r,defer:d}]},o.prototype.getInitialValue=function(){return typeof this.props.initialValue=="string"?this.props.initialValue:typeof this.props.value=="string"?this.props.value:""},o.prototype.bindHandlers=function(c){var a=this;if(this.editor!==void 0){rt(this.editor,c,this.props,this.boundHandlers,function(l){return a.props[l]});var r=function(l){return l.onEditorChange!==void 0||l.value!==void 0},d=r(c),e=r(this.props);!d&&e?(this.editor.on(ae,this.handleEditorChange),this.editor.on(this.beforeInputEvent(),this.handleBeforeInput),this.editor.on("keydown",this.handleBeforeInputSpecial),this.editor.on("keyup",this.handleEditorChangeSpecial),this.editor.on("NewBlock",this.handleEditorChange)):d&&!e&&(this.editor.off(ae,this.handleEditorChange),this.editor.off(this.beforeInputEvent(),this.handleBeforeInput),this.editor.off("keydown",this.handleBeforeInputSpecial),this.editor.off("keyup",this.handleEditorChangeSpecial),this.editor.off("NewBlock",this.handleEditorChange))}},o.propTypes=tt,o.defaultProps={cloudChannel:"8"},o})(b.Component);function Wt(){const{props:i}=Be(),{categories:o=[],sub_categories:c=[],tags:a=[],post:r=null,flash:d={}}=i||{},e=!!r,l=b.useRef(null),u=b.useRef(null),p=b.useRef(new Set),m=b.useRef(null),f=s=>{if(!s)return[];const h=s.match(/<img[^>]+src=["']([^"']+)["']/gi);return h?h.map(g=>{const C=/src=["']([^"']+)["']/.exec(g);return C?C[1]:""}).filter(Boolean):[]},[v,_]=b.useState(()=>r?r.thumbnail_url?r.thumbnail_url:r.thumbnail?r.thumbnail.startsWith("http")||r.thumbnail.startsWith("/")?r.thumbnail:`/storage/${r.thumbnail}`:null:null),[y,S]=b.useState(""),[E,L]=b.useState(!1),[R,F]=b.useState(()=>typeof window<"u"?window.matchMedia("(max-width: 768px)").matches:!1),q=typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").matches;b.useEffect(()=>{const s=h=>{u.current&&!u.current.contains(h.target)&&L(!1)};return document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[]),b.useEffect(()=>{if(typeof window>"u")return;const s=window.matchMedia("(max-width: 768px)"),h=g=>F(g.matches);try{s.addEventListener("change",h)}catch{s.addListener(h)}return()=>{try{s.removeEventListener("change",h)}catch{s.removeListener(h)}}},[]),b.useEffect(()=>{p.current=new Set(f(x.content||""))},[]);const{data:x,setData:w,post:ht,put:mt,processing:le,errors:j}=Fe({category_id:r?.category_id||(o.length>0?o[0].id:0),sub_category_id:r?.sub_category_id||"none",title:r?.title||"",excerpt:r?.excerpt||"",content:r?.content||"",status:r?.status||"draft",is_featured:r?.is_featured||!1,thumbnail:null,tags:r?.tags?.map(s=>s.name)||[]});m.current=x;const K=b.useCallback(async s=>{const h=await Ve(s,800,void 0,.7),g=new FormData;return g.append("image",h),r&&g.append("news_id",r.id.toString()),(await pe.post("/dashboard/posts/upload-image",g)).data.url},[r]),W=b.useCallback(s=>{const h=m.current,g={...h,content:s??h.content,sub_category_id:h.sub_category_id==="none"?null:h.sub_category_id};e&&r?M.post(I.posts.update(r.id).url,{...g,_method:"PUT"}):M.post(I.posts.store().url,g)},[e,r]),Te="1200px",Ie=b.useMemo(()=>({height:Te,plugins:["accordion","advlist","anchor","autolink","autoresize","charmap","code","codesample","directionality","emoticons","fullscreen","help","image","importcss","insertdatetime","link","lists","media","nonbreaking","pagebreak","preview","quickbars","save","searchreplace","table","visualblocks","visualchars","wordcount"],relative_urls:!1,remove_script_host:!0,convert_urls:!0,automatic_uploads:!0,paste_data_images:!1,images_upload_handler:s=>new Promise(async(h,g)=>{try{const C=new File([s.blob()],s.filename(),{type:s.blob().type}),k=await K(C);h(k),setTimeout(()=>{const N=l.current;if(N){const D=N.getContent();w("content",D),W(D)}},500)}catch{g("Image upload failed")}}),editimage_cors_hosts:["picsum.photos"],menubar:"file edit view insert format tools table help",toolbar:"undo redo | fullscreen | accordion accordionremove | blocks fontfamily fontsize | bold italic underline strikethrough | align numlist bullist | link image | table media | lineheight outdent indent| forecolor backcolor removeformat | charmap emoticons | code preview | save print | pagebreak anchor codesample | ltr rtl",image_advtab:!0,link_list:[],image_list:[],image_class_list:[{title:"None",value:""},{title:"Responsive",value:"img-fluid"}],importcss_append:!0,file_picker_callback:async(s,h,g)=>{if(g.filetype==="image"){const C=document.createElement("input");C.setAttribute("type","file"),C.setAttribute("accept","image/*"),C.onchange=async function(){const k=this.files?.[0];if(k)try{const N=await K(k);s(N,{alt:k.name}),setTimeout(()=>{const D=l.current;if(D){const ue=D.getContent();w("content",ue),W(ue)}},100)}catch(N){console.error("Upload failed:",N)}},C.click();return}},image_caption:!0,quickbars_selection_toolbar:"bold italic | quicklink h2 h3 blockquote quickimage quicktable",noneditable_class:"mceNonEditable",toolbar_mode:"sliding",contextmenu:"link image table",skin:q?"oxide-dark":"oxide",content_css:q?"dark":"default",content_style:"body { font-family:Helvetica,Arial,sans-serif; font-size:16px }"}),[K,W,R,q]),Le=s=>{const h=s.target.files?.[0]||null;if(h){w("thumbnail",h);const g=URL.createObjectURL(h);_(g)}},A=s=>{const h=s.trim();h&&!x.tags.includes(h)&&w("tags",[...x.tags,h]),S(""),L(!1)},Pe=s=>{w("tags",x.tags.filter(h=>h!==s))},de=(a||[]).filter(s=>s.name.toLowerCase().includes(y.toLowerCase())&&!x.tags.includes(s.name)),Oe=(c||[]).filter(s=>s.category_id===x.category_id),Re=[{title:"Dashboard",href:I.posts.index().url},{title:"Posts",href:I.posts.index().url}],De=s=>{s.preventDefault();const h=l.current?.getContent()||x.content,g={...x,content:h,sub_category_id:x.sub_category_id==="none"?null:x.sub_category_id};e&&r?M.post(I.posts.update(r.id).url,{...g,_method:"PUT"},{preserveScroll:!0,preserveState:!0}):M.post(I.posts.store().url,g)};return t.jsxs(ze,{breadcrumbs:Re,children:[t.jsx(Ae,{title:e?"Edit Post":"Create Post"}),t.jsxs("div",{className:"mx-auto flex w-full max-w-7xl flex-col gap-4 p-2 sm:p-4 md:p-6",children:[d.success&&t.jsxs(G,{variant:"default",className:"border-green-500/50 bg-green-50 text-green-700 dark:bg-green-950/20 dark:text-green-400",children:[t.jsx(qe,{className:"h-4 w-4"}),t.jsx($,{children:"Success"}),t.jsx(J,{children:d.success})]}),d.error&&t.jsxs(G,{variant:"destructive",children:[t.jsx(he,{className:"h-4 w-4"}),t.jsx($,{children:"Error"}),t.jsx(J,{children:d.error})]}),Object.keys(j).length>0&&t.jsxs(G,{variant:"destructive",children:[t.jsx(he,{className:"h-4 w-4"}),t.jsx($,{children:"Validation Error"}),t.jsx(J,{children:"Please fix the errors below before submitting the form."})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(U,{variant:"ghost",size:"icon",asChild:!0,className:"-ml-2",children:t.jsx(fe,{href:I.posts.index().url,children:t.jsx(Je,{className:"h-5 w-5"})})}),t.jsx("h1",{className:"text-2xl font-semibold tracking-tight",children:e?"Edit Post":"Create New Post"})]}),t.jsxs("form",{onSubmit:De,className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[t.jsx("div",{className:"space-y-6 lg:col-span-2",children:t.jsxs(B,{children:[t.jsxs(H,{children:[t.jsx(z,{children:"Post Content"}),t.jsx(X,{children:"Write the main information for your post."})]}),t.jsxs(V,{className:"space-y-4",children:[t.jsxs("div",{className:"grid gap-2",children:[t.jsx(T,{htmlFor:"title",children:"Title"}),t.jsx(Y,{id:"title",value:x.title,onChange:s=>w("title",s.target.value),placeholder:"Enter post title",required:!0}),j.title&&t.jsx("p",{className:"text-sm text-red-500",children:j.title})]}),t.jsxs("div",{className:"grid gap-2",children:[t.jsx(T,{htmlFor:"excerpt",children:"Excerpt"}),t.jsx(He,{id:"excerpt",value:x.excerpt||"",onChange:s=>w("excerpt",s.target.value),placeholder:"Short summary of the post",rows:3}),j.excerpt&&t.jsx("p",{className:"text-sm text-red-500",children:j.excerpt})]}),t.jsxs("div",{className:"grid gap-2",children:[t.jsx(T,{htmlFor:"content",children:"Content"}),t.jsx("div",{className:"relative min-h-[400px] rounded-md border bg-background p-2",children:t.jsx(ft,{apiKey:"0rl4abq6pz1sf2afw9izxs2pxqr7jbh970rxtxb8r85zwil4",onInit:(s,h)=>l.current=h,value:x.content||"",onEditorChange:async s=>{w("content",s);const h=new Set(f(s)),g=p.current,C=[];g.forEach(k=>{h.has(k)||C.push(k)}),p.current=h;for(const k of C)try{k.includes("/storage/")&&await pe.post("/dashboard/posts/delete-image",{url:k,news_id:r?.id})}catch(N){console.error("Failed to delete image",k,N)}},init:Ie})}),j.content&&t.jsx("p",{className:"text-sm text-red-500",children:j.content})]})]})]})}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs(B,{children:[t.jsxs(H,{children:[t.jsx(z,{children:"Settings"}),t.jsx(X,{children:"Classification and Status"})]}),t.jsxs(V,{className:"space-y-4",children:[t.jsxs("div",{className:"grid gap-2",children:[t.jsx(T,{htmlFor:"category",children:"Category"}),t.jsxs(Q,{value:x.category_id.toString(),onValueChange:s=>w("category_id",parseInt(s)),children:[t.jsx(Z,{children:t.jsx(ee,{placeholder:"Select Category"})}),t.jsx(te,{children:o.map(s=>t.jsx(P,{value:s.id.toString(),children:s.name},s.id))})]}),j.category_id&&t.jsx("p",{className:"text-sm text-red-500",children:j.category_id})]}),t.jsxs("div",{className:"grid gap-2",children:[t.jsx(T,{htmlFor:"sub_category",children:"Sub Category"}),t.jsxs(Q,{value:x.sub_category_id?.toString()||"none",onValueChange:s=>w("sub_category_id",s==="none"?null:parseInt(s)),children:[t.jsx(Z,{children:t.jsx(ee,{placeholder:"Select Sub Category (Optional)"})}),t.jsxs(te,{children:[t.jsx(P,{value:"none",children:"None"}),Oe.map(s=>t.jsx(P,{value:s.id.toString(),children:s.name},s.id))]})]}),j.sub_category_id&&t.jsx("p",{className:"text-sm text-red-500",children:j.sub_category_id})]}),t.jsxs("div",{className:"grid gap-2",children:[t.jsx(T,{htmlFor:"status",children:"Status"}),t.jsxs(Q,{value:x.status,onValueChange:s=>w("status",s),children:[t.jsx(Z,{children:t.jsx(ee,{placeholder:"Select Status"})}),t.jsxs(te,{children:[t.jsx(P,{value:"draft",children:"Draft"}),t.jsx(P,{value:"published",children:"Published"}),t.jsx(P,{value:"archived",children:"Archived"})]})]}),j.status&&t.jsx("p",{className:"text-sm text-red-500",children:j.status})]}),t.jsxs("div",{className:"flex items-center justify-between space-x-2 pt-2",children:[t.jsxs(T,{htmlFor:"is_featured",className:"flex cursor-pointer flex-col gap-1",children:[t.jsx("span",{children:"Featured Post"}),t.jsx("span",{className:"text-xs font-normal text-wrap text-muted-foreground",children:"Show this post in featured section"})]}),t.jsx(Ue,{id:"is_featured",checked:x.is_featured,onCheckedChange:s=>w("is_featured",s)})]})]})]}),t.jsxs(B,{children:[t.jsx(H,{children:t.jsx(z,{children:"Thumbnail"})}),t.jsx(V,{className:"space-y-4",children:t.jsxs("div",{className:"flex flex-col items-center gap-4",children:[v?t.jsx("div",{className:"relative aspect-video w-full overflow-hidden rounded-lg border",children:t.jsx("img",{src:v,alt:"Thumbnail preview",className:"h-full w-full object-cover"})}):t.jsxs("div",{className:"flex aspect-video w-full flex-col items-center justify-center rounded-lg border-2 border-dashed text-muted-foreground",children:[t.jsx(Ye,{className:"mb-2 h-8 w-8"}),t.jsx("span",{className:"text-xs",children:"No image selected"})]}),t.jsxs(T,{className:"w-full cursor-pointer",children:[t.jsx("div",{className:"flex h-9 items-center justify-center rounded-md bg-secondary px-4 py-2 text-sm font-medium text-secondary-foreground transition-colors hover:bg-secondary/80",children:v?"Change Image":"Upload Image"}),t.jsx(Y,{type:"file",className:"hidden",accept:"image/*",onChange:Le})]}),j.thumbnail&&t.jsx("p",{className:"text-sm text-red-500",children:j.thumbnail})]})})]}),t.jsxs(B,{children:[t.jsxs(H,{children:[t.jsx(z,{children:"Tags"}),t.jsx(X,{children:"Add tags to categorize your post."})]}),t.jsxs(V,{className:"space-y-4",children:[t.jsx("div",{className:"flex flex-wrap gap-2",children:x.tags.map(s=>t.jsxs(Me,{variant:"secondary",className:"flex items-center gap-1 px-2 py-1",children:[s,t.jsx("button",{type:"button",onClick:()=>Pe(s),className:"ml-1 rounded-full p-0.5 hover:bg-muted-foreground/20",children:t.jsx(Ke,{className:"h-3 w-3"})})]},s))}),t.jsxs("div",{className:"relative",ref:u,children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsx(Y,{placeholder:"Type a tag name...",value:y,onChange:s=>{S(s.target.value),L(!0)},onFocus:()=>L(!0),onKeyDown:s=>{s.key==="Enter"&&(s.preventDefault(),A(y))}}),t.jsx(U,{type:"button",variant:"outline",size:"icon",onClick:()=>A(y),children:t.jsx(We,{className:"h-4 w-4"})})]}),E&&y&&t.jsx(B,{className:"absolute right-0 left-0 z-50 mt-1 max-h-[200px] overflow-y-auto border shadow-lg",children:t.jsx("div",{className:"p-1",children:de.length>0?de.map(s=>t.jsx("button",{type:"button",className:"w-full rounded-sm px-3 py-2 text-left text-sm hover:bg-muted",onClick:()=>A(s.name),children:s.name},s.id)):t.jsxs("button",{type:"button",className:"w-full px-3 py-2 text-left text-sm text-muted-foreground",onClick:()=>A(y),children:['Create new tag "',y,'"']})})})]}),j.tags&&t.jsx("p",{className:"text-sm text-red-500",children:j.tags})]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(U,{type:"submit",disabled:le,className:"flex-1",children:[le&&t.jsx(Ge,{className:"mr-2 h-4 w-4 animate-spin"}),e?"Update Post":"Save Post"]}),t.jsx(U,{type:"button",variant:"outline",asChild:!0,children:t.jsx(fe,{href:I.posts.index().url,children:"Cancel"})})]})]})]})]})]})}export{Wt as default};
